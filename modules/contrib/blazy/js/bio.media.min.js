!function(t,e){"use strict";"function"==typeof define&&define.amd?define([window.dBlazy,window.Bio],e):"object"==typeof exports?module.exports=e(window.dBlazy,window.Bio):t.BioMedia=e(window.dBlazy,window.Bio)}(this,function(t,e){"use strict";function r(t){return i.apply(this,arguments)}var o=t,i=e,n="data-src",a=["src"],s=["srcset","src"],c=r.prototype=Object.create(e.prototype);return c.constructor=r,c.removeAttrs=function(t,e){o.forEach(e,function(e){t.removeAttribute("data-"+e)})},c.setAttrs=function(t,e){var r=this;o.forEach(e,function(e){r.setAttr(t,e)})},c.setAttr=function(t,e,r){if(t.hasAttribute("data-"+e)){var o=t.getAttribute("data-"+e);"src"===e?t.src=o:t.setAttribute(e,o),r&&t.removeAttribute("data-"+e)}},c.prepare=function(t){return function(){var e=this;if(e.options.breakpoints){var r=[];o.forEach(e.options.breakpoints,function(t){if(a.push(t.src.replace("data-","")),t.width>=e.windowWidth)return n=t.src,r.push(n),!1}),r.length>0&&(n=r[0])}return t.call(this)}}(c.prepare),c.lazyLoad=function(t){return function(e){if(!e.hasAttribute("data-bio-hit")){var r=this,i=e.parentNode,n=r.equal(e,"img"),a=void 0===e.src&&e.classList.contains(r.options.bgClass),s=i&&r.equal(i,"picture"),c=r.equal(e,"video");return s?(o.forEach(i.getElementsByTagName("source"),function(t){r.setAttr(t,"srcset",!0)}),r.setAttr(e,"src",!0),r.loaded(e,r._ok)):c?(o.forEach(e.getElementsByTagName("source"),function(t){r.setAttr(t,"src",!0)}),e.load(),r.loaded(e,r._ok)):n||a?r.setImage(e,a):e.getAttribute("data-src")&&e.hasAttribute("src")&&(r.setAttr(e,"src",!0),r.loaded(e,r._ok)),e.setAttribute("data-bio-hit",1),t.apply(this,arguments)}}}(c.lazyLoad),c.promise=function(t,e){var r=this;return new Promise(function(o,i){var a=new Image;a.src=t.getAttribute(e?n:"data-src"),t.hasAttribute("data-srcset")&&(a.srcset=t.getAttribute("data-srcset"));var c=function(){e?r.setBg(t):r.setAttrs(t,s)};a.onload=function(){c(),o(r._ok)},a.onerror=function(){c(),i(r._er)}})},c.setImage=function(t,e){var r=this;return r.promise(t,e).then(function(o){r.loaded(t,o),r.removeAttrs(t,e?a:s)}).catch(function(e){r.loaded(t,e)}).finally(function(){o.trigger(t,"bio.finally",{options:r.options})})},c.setBg=function(t){t.hasAttribute(n)&&(t.style.backgroundImage='url("'+t.getAttribute(n)+'")',t.removeAttribute("src"))},r});
